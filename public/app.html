<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Velo - Share</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <!-- Nav -->
    <nav class="navbar">
        <a href="/" class="logo">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" fill="currentColor" />
            </svg>
            Velo
        </a>
        <button class="theme-toggle" id="themeToggle" title="Switch Theme">
            <svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2" style="display:none">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
            <svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
        </button>
    </nav>

    <!-- Main App Container -->
    <div
        style="min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 6rem 2rem 2rem;">

        <!-- Setup / Landing Screen -->
        <div id="landingScreen" class="animate-entrance" style="width: 100%; max-width: 900px;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem;">
                <!-- Create Room -->
                <div class="transfer-card hover-lift" id="createRoomCard" style="cursor: pointer;">
                    <div
                        style="width: 60px; height: 60px; background: var(--primary-glow); color: var(--primary); display: flex; align-items: center; justify-content: center; border-radius: 50%; margin: 0 auto 1.5rem;">
                        <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M12 5v14M5 12h14" />
                        </svg>
                    </div>
                    <h2>Start a Room</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 2rem;">Create a unique space to share files.
                    </p>
                    <button class="btn-primary" style="width: 100%; justify-content: center;">Create Now</button>
                </div>

                <!-- Join Room -->
                <div class="transfer-card hover-lift" id="joinRoomCard" style="cursor: pointer;">
                    <div
                        style="width: 60px; height: 60px; background: var(--accent-glow); color: var(--accent); display: flex; align-items: center; justify-content: center; border-radius: 50%; margin: 0 auto 1.5rem;">
                        <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4" />
                            <polyline points="10 17 15 12 10 7" />
                            <line x1="15" y1="12" x2="3" y2="12" />
                        </svg>
                    </div>
                    <h2>Join a Room</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 2rem;">Enter a code to connect with a peer.
                    </p>
                    <button class="btn-ghost" style="width: 100%; justify-content: center;">Enter Code</button>
                </div>
            </div>
        </div>

        <!-- Room Active Screen (Hidden by default) -->
        <div id="roomScreen" class="animate-entrance"
            style="display: none; width: 100%; flex-direction: column; align-items: center; padding: 0 1rem;">

            <!-- Header Bar -->
            <div
                style="width: 100%; max-width: 1400px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <div class="glass"
                    style="padding: 0.5rem 1.5rem; border-radius: 99px; display: flex; gap: 1rem; align-items: center;">
                    <span
                        style="color: var(--text-muted); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.1em;">R
                        O O M</span>
                    <span id="roomCodeDisplay"
                        style="font-family: var(--font-mono); font-weight: 700; color: var(--primary); font-size: 1.2rem;">------</span>
                    <button id="copyRoomCode" class="btn-ghost"
                        style="padding: 0.2rem 0.8rem; font-size: 0.8rem; height: auto;">Copy</button>
                </div>

                <div id="headerStats" style="display: flex; gap: 1rem;">
                    <div class="glass"
                        style="padding: 0.5rem 1.5rem; border-radius: 99px; display: flex; gap: 0.5rem; align-items: center;">
                        <span style="color: var(--text-muted);">Speed</span>
                        <span id="currentSpeed" style="font-weight: 600; color: var(--accent);">0 MB/s</span>
                    </div>
                </div>

                <button id="leaveRoom" class="btn-ghost"
                    style="color: var(--danger); border-color: var(--danger); padding: 0.5rem 1.5rem;">Disconnect</button>
            </div>

            <!-- New Layout Grid -->
            <div class="room-layout">

                <!-- Left: Peers -->
                <aside class="floating-panel">
                    <div class="panel-title">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                            <circle cx="9" cy="7" r="4" />
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                        </svg>
                        Peers <span id="peerCount"
                            style="background: var(--bg-surface); padding: 0.1rem 0.5rem; border-radius: 10px; font-size: 0.8rem;">0</span>
                    </div>
                    <ul id="usersList" style="list-style: none;">
                        <!-- Users go here -->
                    </ul>
                </aside>

                <!-- Center: Portal -->
                <main class="center-stage">
                    <div class="velo-portal" id="dropZone">
                        <svg class="portal-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="1.5">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="17 8 12 3 7 8" />
                            <line x1="12" y1="3" x2="12" y2="15" />
                        </svg>
                        <div class="portal-text">Drop Files Here</div>
                        <div class="portal-subtext">to send instantly</div>
                        <input type="file" id="fileInput" multiple hidden>
                    </div>

                    <div style="font-size: 0.9rem; color: var(--text-muted); max-width: 400px; text-align: center;">
                        Direct P2P Tunnel Established â€¢ End-to-End Encrypted
                    </div>
                </main>

                <!-- Right: Queue -->
                <aside class="floating-panel">
                    <div class="panel-title">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12" />
                        </svg>
                        Transfers & Stats
                    </div>

                    <!-- Stats Grid -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-bottom: 2rem;">
                        <div
                            style="background: var(--bg-surface); padding: 0.8rem; border-radius: 12px; text-align: center;">
                            <div style="font-size: 0.7rem; color: var(--text-muted);">PEAK</div>
                            <div id="peakSpeed" style="font-weight: 600;">0 MB/s</div>
                        </div>
                        <div
                            style="background: var(--bg-surface); padding: 0.8rem; border-radius: 12px; text-align: center;">
                            <div style="font-size: 0.7rem; color: var(--text-muted);">TOTAL</div>
                            <div id="totalTransferred" style="font-weight: 600;">0 MB</div>
                        </div>
                        <!-- Need these IDs for app.js but can hide them if not used visually -->
                        <div id="speedValue" style="display: none;"></div>
                        <div id="speedArc" style="display: none;"></div>
                        <div id="avgSpeed" style="display: none;"></div>
                    </div>

                    <div class="panel-title">Queue</div>
                    <div id="transferQueue" class="queue-container" style="flex: 1; padding: 0; max-height: none;">
                        <div id="queueList"></div>
                    </div>
                </aside>

            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="setupModal" class="glass"
        style="display: none; position: fixed; inset: 0; align-items: center; justify-content: center; z-index: 200; background: rgba(0,0,0,0.5);">
        <div class="transfer-card" style="width: 100%; max-width: 400px; position: relative;">
            <button id="closeModal"
                style="position: absolute; top: 1.5rem; right: 1.5rem; background: none; border: none; font-size: 1.5rem; color: var(--text-muted); cursor: pointer;">&times;</button>
            <h2 id="modalTitle" style="margin-bottom: 2rem;">Identity</h2>

            <div style="text-align: left; margin-bottom: 1.5rem;">
                <label style="display: block; color: var(--text-muted); font-size: 0.9rem; margin-bottom: 0.5rem;">Your
                    Name</label>
                <input type="text" id="usernameInput" placeholder="e.g. Maverick"
                    style="width: 100%; padding: 1rem; border-radius: 12px; border: 1px solid var(--border-light); background: var(--bg-main); color: var(--text-primary); outline: none;">
            </div>

            <div id="roomCodeGroup" style="display: none; text-align: left; margin-bottom: 1.5rem;">
                <label style="display: block; color: var(--text-muted); font-size: 0.9rem; margin-bottom: 0.5rem;">Room
                    Code</label>
                <input type="text" id="roomCodeInput" placeholder="XYZ123" maxlength="6"
                    style="width: 100%; padding: 1rem; border-radius: 12px; border: 1px solid var(--border-light); background: var(--bg-main); color: var(--text-primary); outline: none; text-transform: uppercase;">
            </div>

            <button id="confirmSetup" class="btn-primary"
                style="width: 100%; justify-content: center;">Continue</button>
        </div>
    </div>

    <div id="toastContainer"
        style="position: fixed; bottom: 2rem; right: 2rem; display: flex; flex-direction: column; gap: 1rem; z-index: 300;">
    </div>

    <!-- Logic -->
    <script src="js/theme.js"></script>
    <script src="js/webrtc.js"></script>
    <script src="js/transfer.js"></script>
    <script src="js/app.js"></script>
    <script>
        document.querySelectorAll('.animate-entrance').forEach(el => {
            el.style.opacity = '1';
        });
    </script>
</body>

</html>